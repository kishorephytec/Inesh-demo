###############################################################################
#
# IAR ANSI C/C++ Compiler V9.50.2.385/W64 for ARM         29/Mar/2025  15:53:59
# Copyright 1999-2024 IAR Systems AB.
#
#    Cpu mode                     =  thumb
#    Endian                       =  little
#    Source file                  =
#        D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\mbedtls\library\psa_crypto_ecp.c
#    Command line                 =
#        -f "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\ewarm-iar\obj\library_17211336700577820660.dir\psa_crypto_ecp.o.rsp"
#        ("D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\mbedtls\library\psa_crypto_ecp.c"
#        -D DEBUG_EFM=1 -D EFR32FG28B322F1024IM48=1 -D
#        configNUM_SDK_THREAD_LOCAL_STORAGE_POINTERS=2 -D
#        SL_COMPONENT_CATALOG_PRESENT=1 -D
#        MBEDTLS_CONFIG_FILE=<sl_mbedtls_config.h> -D
#        MBEDTLS_PSA_CRYPTO_CONFIG_FILE=<psa_crypto_config.h> -D
#        SL_RAIL_LIB_MULTIPROTOCOL_SUPPORT=0 -D
#        SL_RAIL_UTIL_PA_CONFIG_HEADER=<sl_rail_util_pa_config.h> -D
#        RTT_USE_ASM=0 -lC "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\ewarm-iar\lst\library_17211336700577820660.dir"
#        --diag_suppress Pa050 -o "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\ewarm-iar\obj\library_17211336700577820660.dir"
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M33 --cmse --cmse -e --fpu=VFPv5_sp --dlib_config
#        "C:\Program Files\IAR Systems\Embedded Workbench
#        9.2\arm\inc\c\DLib_Config_Normal.h" -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\mbedtls\library\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App 1\Wisun_Node_App\config\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App 1\Wisun_Node_App\config\rail\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App 1\Wisun_Node_App\config\wisun\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App 1\Wisun_Node_App\.\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\Device\SiliconLabs\EFR32FG28\Include\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\app_project_info\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\common\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\service\cli\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\service\cli\src\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\CMSIS\Core\Include\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\CMSIS\RTOS2\Include\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\service\device_init\inc\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\emdrv\common\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\emlib\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\service\iostream\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\security\sl_component\sl_mbedtls_support\config\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\security\sl_component\sl_mbedtls_support\config\preset\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\security\sl_component\sl_mbedtls_support\inc\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\mbedtls\include\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\mbedtls\library\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\common\source\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\common\include\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\cpu\include\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\ports\source\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\kernel\source\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\micrium_os\kernel\include\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\emdrv\nvm3\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\peripheral\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\printf\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\printf\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\security\sl_component\sl_psa_driver\inc\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\common\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\protocol\ble\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\protocol\ieee802154\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\protocol\wmbus\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\protocol\zwave\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\chip\efr32\efr32xg2x\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\protocol\sidewalk\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\plugin\pa-conversions\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\plugin\pa-conversions\efr32xg28\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\radio\rail_lib\plugin\rail_util_pti\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\security\sl_component\se_manager\inc\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\security\sl_component\se_manager\src\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\segger\systemview\SEGGER\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\util\silicon_labs\silabs_core\memory_manager\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\common\toolchain\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\service\system\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\app_core\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\app_setting\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\cli_util\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\event_manager\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\ns_list\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\ping\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\trace_util\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\trace_util\nanostack\nanostack-libservice\mbed-client-libservice\\"
#        -I "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\app\wisun\component\udp_client\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\platform\service\sleeptimer\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\protocol\wisun\plugin\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\protocol\wisun\stack\inc\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\gecko_sdk_4.4.5\protocol\wisun\stack\inc\socket\\" -I
#        "D:\Inesh_wisun\Wisun_Node_App 1\Wisun_Node_App\autogen\\" -On
#        --use_c++_inline) --dependencies=n "D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\ewarm-iar\obj\library_17211336700577820660.dir\psa_crypto_ecp.o.iar_deps"
#    Locale                       =  C
#    List file                    =
#        D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\ewarm-iar\lst\library_17211336700577820660.dir\psa_crypto_ecp.lst
#    Object file                  =
#        D:\Inesh_wisun\Wisun_Node_App
#        1\Wisun_Node_App\ewarm-iar\obj\library_17211336700577820660.dir\psa_crypto_ecp.o
#    Runtime model:                  
#      __CPP_Runtime              =  1
#      __SystemLibrary            =  DLib
#      __dlib_file_descriptor     =  0
#      __dlib_full_locale_support =  0
#      __dlib_version             =  6
#
###############################################################################

D:\Inesh_wisun\Wisun_Node_App 1\Wisun_Node_App\gecko_sdk_4.4.5\util\third_party\mbedtls\library\psa_crypto_ecp.c
      1          /*
      2           *  PSA ECP layer on top of Mbed TLS crypto
      3           */
      4          /*
      5           *  Copyright The Mbed TLS Contributors
      6           *  SPDX-License-Identifier: Apache-2.0
      7           *
      8           *  Licensed under the Apache License, Version 2.0 (the "License"); you may
      9           *  not use this file except in compliance with the License.
     10           *  You may obtain a copy of the License at
     11           *
     12           *  http://www.apache.org/licenses/LICENSE-2.0
     13           *
     14           *  Unless required by applicable law or agreed to in writing, software
     15           *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
     16           *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     17           *  See the License for the specific language governing permissions and
     18           *  limitations under the License.
     19           */
     20          
     21          #include "common.h"
     22          
     23          #if defined(MBEDTLS_PSA_CRYPTO_C)
     24          
     25          #include <psa/crypto.h>
     26          #include "psa_crypto_core.h"
     27          #include "psa_crypto_ecp.h"
     28          #include "psa_crypto_random_impl.h"
     29          #include "md_psa.h"
     30          
     31          #include <stdlib.h>
     32          #include <string.h>
     33          #include "mbedtls/platform.h"
     34          
     35          #include <mbedtls/ecdsa.h>
     36          #include <mbedtls/ecdh.h>
     37          #include <mbedtls/ecp.h>
     38          #include <mbedtls/error.h>
     39          
     40          #if defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_BASIC) || \
     41              defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_IMPORT) || \
     42              defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_EXPORT) || \
     43              defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_PUBLIC_KEY) || \
     44              defined(MBEDTLS_PSA_BUILTIN_ALG_ECDSA) || \
     45              defined(MBEDTLS_PSA_BUILTIN_ALG_DETERMINISTIC_ECDSA) || \
     46              defined(MBEDTLS_PSA_BUILTIN_ALG_ECDH)

   \                                 In section .text, align 2, keep-with-next
     47          psa_status_t mbedtls_psa_ecp_load_representation(
     48              psa_key_type_t type, size_t curve_bits,
     49              const uint8_t *data, size_t data_length,
     50              mbedtls_ecp_keypair **p_ecp)
     51          {
   \                     mbedtls_psa_ecp_load_representation: (+1)
   \        0x0   0xE92D 0x4FFE      PUSH     {R1-R11,LR}
   \        0x4   0x4683             MOV      R11,R0
   \        0x6   0x000E             MOVS     R6,R1
   \        0x8   0x4690             MOV      R8,R2
   \        0xA   0x4699             MOV      R9,R3
     52              mbedtls_ecp_group_id grp_id = MBEDTLS_ECP_DP_NONE;
   \        0xC   0x2000             MOVS     R0,#+0
   \        0xE   0xF88D 0x0004      STRB     R0,[SP, #+4]
     53              psa_status_t status;
     54              mbedtls_ecp_keypair *ecp = NULL;
   \       0x12   0x2400             MOVS     R4,#+0
     55              size_t curve_bytes = data_length;
   \       0x14   0xF8CD 0x9000      STR      R9,[SP, #+0]
     56              int explicit_bits = (curve_bits != 0);
   \       0x18   0x2E00             CMP      R6,#+0
   \       0x1A   0xD001             BEQ.N    ??mbedtls_psa_ecp_load_representation_0
   \       0x1C   0x2501             MOVS     R5,#+1
   \       0x1E   0xE000             B.N      ??mbedtls_psa_ecp_load_representation_1
   \                     ??mbedtls_psa_ecp_load_representation_0: (+1)
   \       0x20   0x2500             MOVS     R5,#+0
     57          
     58              if (PSA_KEY_TYPE_IS_PUBLIC_KEY(type) &&
     59                  PSA_KEY_TYPE_ECC_GET_FAMILY(type) != PSA_ECC_FAMILY_MONTGOMERY) {
   \                     ??mbedtls_psa_ecp_load_representation_1: (+1)
   \       0x22   0x4658             MOV      R0,R11
   \       0x24   0xB280             UXTH     R0,R0
   \       0x26   0xF410 0x40E0      ANDS     R0,R0,#0x7000
   \       0x2A   0xF5B0 0x4F80      CMP      R0,#+16384
   \       0x2E   0xD116             BNE.N    ??mbedtls_psa_ecp_load_representation_2
   \       0x30   0x4659             MOV      R1,R11
   \       0x32   0xB289             UXTH     R1,R1
   \       0x34   0x.... 0x....      LDR.W    R0,??DataTable7
   \       0x38   0x4001             ANDS     R1,R0,R1
   \       0x3A   0xF5B1 0x4F82      CMP      R1,#+16640
   \       0x3E   0xD101             BNE.N    ??mbedtls_psa_ecp_load_representation_3
   \       0x40   0x4658             MOV      R0,R11
   \       0x42   0xE000             B.N      ??mbedtls_psa_ecp_load_representation_4
   \                     ??mbedtls_psa_ecp_load_representation_3: (+1)
   \       0x44   0x2000             MOVS     R0,#+0
   \                     ??mbedtls_psa_ecp_load_representation_4: (+1)
   \       0x46   0xB2C0             UXTB     R0,R0
   \       0x48   0x2841             CMP      R0,#+65
   \       0x4A   0xD008             BEQ.N    ??mbedtls_psa_ecp_load_representation_2
     60                  /* A Weierstrass public key is represented as:
     61                   * - The byte 0x04;
     62                   * - `x_P` as a `ceiling(m/8)`-byte string, big-endian;
     63                   * - `y_P` as a `ceiling(m/8)`-byte string, big-endian.
     64                   * So its data length is 2m+1 where m is the curve size in bits.
     65                   */
     66                  if ((data_length & 1) == 0) {
   \       0x4C   0xEA5F 0x70C9      LSLS     R0,R9,#+31
   \       0x50   0xD402             BMI.N    ??mbedtls_psa_ecp_load_representation_5
     67                      return PSA_ERROR_INVALID_ARGUMENT;
   \       0x52   0xF07F 0x0086      MVNS     R0,#+134
   \       0x56   0xE077             B.N      ??mbedtls_psa_ecp_load_representation_6
     68                  }
     69                  curve_bytes = data_length / 2;
   \                     ??mbedtls_psa_ecp_load_representation_5: (+1)
   \       0x58   0x4648             MOV      R0,R9
   \       0x5A   0x0840             LSRS     R0,R0,#+1
   \       0x5C   0x9000             STR      R0,[SP, #+0]
     70          
     71                  /* Montgomery public keys are represented in compressed format, meaning
     72                   * their curve_bytes is equal to the amount of input. */
     73          
     74                  /* Private keys are represented in uncompressed private random integer
     75                   * format, meaning their curve_bytes is equal to the amount of input. */
     76              }
     77          
     78              if (explicit_bits) {
   \                     ??mbedtls_psa_ecp_load_representation_2: (+1)
   \       0x5E   0x2D00             CMP      R5,#+0
   \       0x60   0xD007             BEQ.N    ??mbedtls_psa_ecp_load_representation_7
     79                  /* With an explicit bit-size, the data must have the matching length. */
     80                  if (curve_bytes != PSA_BITS_TO_BYTES(curve_bits)) {
   \       0x62   0x9900             LDR      R1,[SP, #+0]
   \       0x64   0x1DF0             ADDS     R0,R6,#+7
   \       0x66   0xEBB1 0x0FD0      CMP      R1,R0, LSR #+3
   \       0x6A   0xD005             BEQ.N    ??mbedtls_psa_ecp_load_representation_8
     81                      return PSA_ERROR_INVALID_ARGUMENT;
   \       0x6C   0xF07F 0x0086      MVNS     R0,#+134
   \       0x70   0xE06A             B.N      ??mbedtls_psa_ecp_load_representation_6
     82                  }
     83              } else {
     84                  /* We need to infer the bit-size from the data. Since the only
     85                   * information we have is the length in bytes, the value of curve_bits
     86                   * at this stage is rounded up to the nearest multiple of 8. */
     87                  curve_bits = PSA_BYTES_TO_BITS(curve_bytes);
   \                     ??mbedtls_psa_ecp_load_representation_7: (+1)
   \       0x72   0x9800             LDR      R0,[SP, #+0]
   \       0x74   0x00C0             LSLS     R0,R0,#+3
   \       0x76   0x0006             MOVS     R6,R0
     88              }
     89          
     90              /* Allocate and initialize a key representation. */
     91              ecp = mbedtls_calloc(1, sizeof(mbedtls_ecp_keypair));
   \                     ??mbedtls_psa_ecp_load_representation_8: (+1)
   \       0x78   0x2180             MOVS     R1,#+128
   \       0x7A   0x2001             MOVS     R0,#+1
   \       0x7C   0x.... 0x....      BL       sl_calloc
   \       0x80   0x0007             MOVS     R7,R0
     92              if (ecp == NULL) {
   \       0x82   0x2F00             CMP      R7,#+0
   \       0x84   0xD102             BNE.N    ??mbedtls_psa_ecp_load_representation_9
     93                  return PSA_ERROR_INSUFFICIENT_MEMORY;
   \       0x86   0xF07F 0x008C      MVNS     R0,#+140
   \       0x8A   0xE05D             B.N      ??mbedtls_psa_ecp_load_representation_6
     94              }
     95              mbedtls_ecp_keypair_init(ecp);
   \                     ??mbedtls_psa_ecp_load_representation_9: (+1)
   \       0x8C   0x0038             MOVS     R0,R7
   \       0x8E   0x.... 0x....      BL       mbedtls_ecp_keypair_init
     96          
     97              /* Load the group. */
     98              grp_id = mbedtls_ecc_group_of_psa(PSA_KEY_TYPE_ECC_GET_FAMILY(type),
     99                                                curve_bits, !explicit_bits);
   \       0x92   0x2D00             CMP      R5,#+0
   \       0x94   0xD101             BNE.N    ??mbedtls_psa_ecp_load_representation_10
   \       0x96   0x2201             MOVS     R2,#+1
   \       0x98   0xE000             B.N      ??mbedtls_psa_ecp_load_representation_11
   \                     ??mbedtls_psa_ecp_load_representation_10: (+1)
   \       0x9A   0x2200             MOVS     R2,#+0
   \                     ??mbedtls_psa_ecp_load_representation_11: (+1)
   \       0x9C   0x4659             MOV      R1,R11
   \       0x9E   0xB289             UXTH     R1,R1
   \       0xA0   0x.... 0x....      LDR.W    R0,??DataTable7
   \       0xA4   0x4001             ANDS     R1,R0,R1
   \       0xA6   0xF5B1 0x4F82      CMP      R1,#+16640
   \       0xAA   0xD101             BNE.N    ??mbedtls_psa_ecp_load_representation_12
   \       0xAC   0x4658             MOV      R0,R11
   \       0xAE   0xE000             B.N      ??mbedtls_psa_ecp_load_representation_13
   \                     ??mbedtls_psa_ecp_load_representation_12: (+1)
   \       0xB0   0x2000             MOVS     R0,#+0
   \                     ??mbedtls_psa_ecp_load_representation_13: (+1)
   \       0xB2   0xB2D2             UXTB     R2,R2
   \       0xB4   0x0031             MOVS     R1,R6
   \       0xB6   0xB2C0             UXTB     R0,R0
   \       0xB8   0x.... 0x....      BL       mbedtls_ecc_group_of_psa
   \       0xBC   0x4682             MOV      R10,R0
    100              if (grp_id == MBEDTLS_ECP_DP_NONE) {
   \       0xBE   0x4650             MOV      R0,R10
   \       0xC0   0xB2C0             UXTB     R0,R0
   \       0xC2   0x2800             CMP      R0,#+0
   \       0xC4   0xD102             BNE.N    ??mbedtls_psa_ecp_load_representation_14
    101                  /* We can't distinguish between a nonsensical family/size combination
    102                   * (which would warrant PSA_ERROR_INVALID_ARGUMENT) and a
    103                   * well-regarded curve that Mbed TLS just doesn't know about (which
    104                   * would warrant PSA_ERROR_NOT_SUPPORTED). For uniformity with how
    105                   * curves that Mbed TLS knows about but for which support is disabled
    106                   * at build time, return NOT_SUPPORTED. */
    107                  status = PSA_ERROR_NOT_SUPPORTED;
   \       0xC6   0xF07F 0x0485      MVNS     R4,#+133
    108                  goto exit;
   \       0xCA   0xE034             B.N      ??mbedtls_psa_ecp_load_representation_15
    109              }
    110          
    111              status = mbedtls_to_psa_error(
    112                  mbedtls_ecp_group_load(&ecp->grp, grp_id));
   \                     ??mbedtls_psa_ecp_load_representation_14: (+1)
   \       0xCC   0x4651             MOV      R1,R10
   \       0xCE   0xB2C9             UXTB     R1,R1
   \       0xD0   0x0038             MOVS     R0,R7
   \       0xD2   0x.... 0x....      BL       mbedtls_ecp_group_load
   \       0xD6   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xDA   0x0004             MOVS     R4,R0
    113              if (status != PSA_SUCCESS) {
   \       0xDC   0x2C00             CMP      R4,#+0
   \       0xDE   0xD12A             BNE.N    ??mbedtls_psa_ecp_load_representation_15
    114                  goto exit;
    115              }
    116          
    117              /* Load the key material. */
    118              if (PSA_KEY_TYPE_IS_PUBLIC_KEY(type)) {
   \                     ??mbedtls_psa_ecp_load_representation_16: (+1)
   \       0xE0   0x4658             MOV      R0,R11
   \       0xE2   0xB280             UXTH     R0,R0
   \       0xE4   0xF410 0x40E0      ANDS     R0,R0,#0x7000
   \       0xE8   0xF5B0 0x4F80      CMP      R0,#+16384
   \       0xEC   0xD116             BNE.N    ??mbedtls_psa_ecp_load_representation_17
    119                  /* Load the public value. */
    120                  status = mbedtls_to_psa_error(
    121                      mbedtls_ecp_point_read_binary(&ecp->grp, &ecp->Q,
    122                                                    data,
    123                                                    data_length));
   \       0xEE   0x464B             MOV      R3,R9
   \       0xF0   0x4642             MOV      R2,R8
   \       0xF2   0xF117 0x0168      ADDS     R1,R7,#+104
   \       0xF6   0x0038             MOVS     R0,R7
   \       0xF8   0x.... 0x....      BL       mbedtls_ecp_point_read_binary
   \       0xFC   0x.... 0x....      BL       mbedtls_to_psa_error
   \      0x100   0x0004             MOVS     R4,R0
    124                  if (status != PSA_SUCCESS) {
   \      0x102   0x2C00             CMP      R4,#+0
   \      0x104   0xD117             BNE.N    ??mbedtls_psa_ecp_load_representation_15
    125                      goto exit;
    126                  }
    127          
    128                  /* Check that the point is on the curve. */
    129                  status = mbedtls_to_psa_error(
    130                      mbedtls_ecp_check_pubkey(&ecp->grp, &ecp->Q));
   \                     ??mbedtls_psa_ecp_load_representation_18: (+1)
   \      0x106   0xF117 0x0168      ADDS     R1,R7,#+104
   \      0x10A   0x0038             MOVS     R0,R7
   \      0x10C   0x.... 0x....      BL       mbedtls_ecp_check_pubkey
   \      0x110   0x.... 0x....      BL       mbedtls_to_psa_error
   \      0x114   0x0004             MOVS     R4,R0
    131                  if (status != PSA_SUCCESS) {
   \      0x116   0x2C00             CMP      R4,#+0
   \      0x118   0xD00B             BEQ.N    ??mbedtls_psa_ecp_load_representation_19
    132                      goto exit;
   \      0x11A   0xE00C             B.N      ??mbedtls_psa_ecp_load_representation_15
    133                  }
    134              } else {
    135                  /* Load and validate the secret value. */
    136                  status = mbedtls_to_psa_error(
    137                      mbedtls_ecp_read_key(ecp->grp.id,
    138                                           ecp,
    139                                           data,
    140                                           data_length));
   \                     ??mbedtls_psa_ecp_load_representation_17: (+1)
   \      0x11C   0x464B             MOV      R3,R9
   \      0x11E   0x4642             MOV      R2,R8
   \      0x120   0x0039             MOVS     R1,R7
   \      0x122   0x7838             LDRB     R0,[R7, #+0]
   \      0x124   0x.... 0x....      BL       mbedtls_ecp_read_key
   \      0x128   0x.... 0x....      BL       mbedtls_to_psa_error
   \      0x12C   0x0004             MOVS     R4,R0
    141                  if (status != PSA_SUCCESS) {
   \      0x12E   0x2C00             CMP      R4,#+0
   \      0x130   0xD101             BNE.N    ??mbedtls_psa_ecp_load_representation_15
    142                      goto exit;
    143                  }
    144              }
    145          
    146              *p_ecp = ecp;
   \                     ??mbedtls_psa_ecp_load_representation_19: (+1)
   \      0x132   0x980C             LDR      R0,[SP, #+48]
   \      0x134   0x6007             STR      R7,[R0, #+0]
    147          exit:
    148              if (status != PSA_SUCCESS) {
   \                     ??mbedtls_psa_ecp_load_representation_15: (+1)
   \      0x136   0x2C00             CMP      R4,#+0
   \      0x138   0xD005             BEQ.N    ??mbedtls_psa_ecp_load_representation_20
    149                  mbedtls_ecp_keypair_free(ecp);
   \      0x13A   0x0038             MOVS     R0,R7
   \      0x13C   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    150                  mbedtls_free(ecp);
   \      0x140   0x0038             MOVS     R0,R7
   \      0x142   0x.... 0x....      BL       sl_free
    151              }
    152          
    153              return status;
   \                     ??mbedtls_psa_ecp_load_representation_20: (+1)
   \      0x146   0x0020             MOVS     R0,R4
   \                     ??mbedtls_psa_ecp_load_representation_6: (+1)
   \      0x148   0xE8BD 0x8FFE      POP      {R1-R11,PC}
    154          }
    155          #endif /* defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_BASIC) ||
    156                  * defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_IMPORT) ||
    157                  * defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_EXPORT) ||
    158                  * defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_PUBLIC_KEY) ||
    159                  * defined(MBEDTLS_PSA_BUILTIN_ALG_ECDSA) ||
    160                  * defined(MBEDTLS_PSA_BUILTIN_ALG_DETERMINISTIC_ECDSA) ||
    161                  * defined(MBEDTLS_PSA_BUILTIN_ALG_ECDH) */
    162          
    163          #if defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_IMPORT) || \
    164              defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_EXPORT) || \
    165              defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_PUBLIC_KEY)
    166          

   \                                 In section .text, align 2, keep-with-next
    167          psa_status_t mbedtls_psa_ecp_import_key(
    168              const psa_key_attributes_t *attributes,
    169              const uint8_t *data, size_t data_length,
    170              uint8_t *key_buffer, size_t key_buffer_size,
    171              size_t *key_buffer_length, size_t *bits)
    172          {
   \                     mbedtls_psa_ecp_import_key: (+1)
   \        0x0   0xE92D 0x47FC      PUSH     {R2-R10,LR}
   \        0x4   0x4682             MOV      R10,R0
   \        0x6   0x000D             MOVS     R5,R1
   \        0x8   0x0016             MOVS     R6,R2
   \        0xA   0x001F             MOVS     R7,R3
   \        0xC   0xF8DD 0x8028      LDR      R8,[SP, #+40]
   \       0x10   0xF8DD 0x9030      LDR      R9,[SP, #+48]
    173              psa_status_t status;
    174              mbedtls_ecp_keypair *ecp = NULL;
   \       0x14   0x2000             MOVS     R0,#+0
   \       0x16   0x9001             STR      R0,[SP, #+4]
    175          
    176              /* Parse input */
    177              status = mbedtls_psa_ecp_load_representation(attributes->core.type,
    178                                                           attributes->core.bits,
    179                                                           data,
    180                                                           data_length,
    181                                                           &ecp);
   \       0x18   0xA801             ADD      R0,SP,#+4
   \       0x1A   0x9000             STR      R0,[SP, #+0]
   \       0x1C   0x0033             MOVS     R3,R6
   \       0x1E   0x002A             MOVS     R2,R5
   \       0x20   0xF8BA 0x1002      LDRH     R1,[R10, #+2]
   \       0x24   0xF8BA 0x0000      LDRH     R0,[R10, #+0]
   \       0x28   0x.... 0x....      BL       mbedtls_psa_ecp_load_representation
   \       0x2C   0x0004             MOVS     R4,R0
    182              if (status != PSA_SUCCESS) {
   \       0x2E   0x2C00             CMP      R4,#+0
   \       0x30   0xD122             BNE.N    ??mbedtls_psa_ecp_import_key_0
    183                  goto exit;
    184              }
    185          
    186              if (PSA_KEY_TYPE_ECC_GET_FAMILY(attributes->core.type) ==
    187                  PSA_ECC_FAMILY_MONTGOMERY) {
   \                     ??mbedtls_psa_ecp_import_key_1: (+1)
   \       0x32   0xF8BA 0x1000      LDRH     R1,[R10, #+0]
   \       0x36   0x.... 0x....      LDR.W    R0,??DataTable7
   \       0x3A   0x4001             ANDS     R1,R0,R1
   \       0x3C   0xF5B1 0x4F82      CMP      R1,#+16640
   \       0x40   0xD102             BNE.N    ??mbedtls_psa_ecp_import_key_2
   \       0x42   0xF8BA 0x0000      LDRH     R0,[R10, #+0]
   \       0x46   0xE000             B.N      ??mbedtls_psa_ecp_import_key_3
   \                     ??mbedtls_psa_ecp_import_key_2: (+1)
   \       0x48   0x2000             MOVS     R0,#+0
   \                     ??mbedtls_psa_ecp_import_key_3: (+1)
   \       0x4A   0xB2C0             UXTB     R0,R0
   \       0x4C   0x2841             CMP      R0,#+65
   \       0x4E   0xD105             BNE.N    ??mbedtls_psa_ecp_import_key_4
    188                  *bits = ecp->grp.nbits + 1;
   \       0x50   0x9801             LDR      R0,[SP, #+4]
   \       0x52   0x6C00             LDR      R0,[R0, #+64]
   \       0x54   0x1C40             ADDS     R0,R0,#+1
   \       0x56   0xF8C9 0x0000      STR      R0,[R9, #+0]
   \       0x5A   0xE003             B.N      ??mbedtls_psa_ecp_import_key_5
    189              } else {
    190                  *bits = ecp->grp.nbits;
   \                     ??mbedtls_psa_ecp_import_key_4: (+1)
   \       0x5C   0x9801             LDR      R0,[SP, #+4]
   \       0x5E   0x6C00             LDR      R0,[R0, #+64]
   \       0x60   0xF8C9 0x0000      STR      R0,[R9, #+0]
    191              }
    192          
    193              /* Re-export the data to PSA export format. There is currently no support
    194               * for other input formats then the export format, so this is a 1-1
    195               * copy operation. */
    196              status = mbedtls_psa_ecp_export_key(attributes->core.type,
    197                                                  ecp,
    198                                                  key_buffer,
    199                                                  key_buffer_size,
    200                                                  key_buffer_length);
   \                     ??mbedtls_psa_ecp_import_key_5: (+1)
   \       0x64   0x980B             LDR      R0,[SP, #+44]
   \       0x66   0x9000             STR      R0,[SP, #+0]
   \       0x68   0x4643             MOV      R3,R8
   \       0x6A   0x003A             MOVS     R2,R7
   \       0x6C   0x9901             LDR      R1,[SP, #+4]
   \       0x6E   0xF8BA 0x0000      LDRH     R0,[R10, #+0]
   \       0x72   0x.... 0x....      BL       mbedtls_psa_ecp_export_key
   \       0x76   0x0004             MOVS     R4,R0
    201          exit:
    202              /* Always free the PK object (will also free contained ECP context) */
    203              mbedtls_ecp_keypair_free(ecp);
   \                     ??mbedtls_psa_ecp_import_key_0: (+1)
   \       0x78   0x9801             LDR      R0,[SP, #+4]
   \       0x7A   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    204              mbedtls_free(ecp);
   \       0x7E   0x9801             LDR      R0,[SP, #+4]
   \       0x80   0x.... 0x....      BL       sl_free
    205          
    206              return status;
   \       0x84   0x0020             MOVS     R0,R4
   \       0x86   0xE8BD 0x87F6      POP      {R1,R2,R4-R10,PC}
    207          }
    208          

   \                                 In section .text, align 2, keep-with-next
    209          psa_status_t mbedtls_psa_ecp_export_key(psa_key_type_t type,
    210                                                  mbedtls_ecp_keypair *ecp,
    211                                                  uint8_t *data,
    212                                                  size_t data_size,
    213                                                  size_t *data_length)
    214          {
   \                     mbedtls_psa_ecp_export_key: (+1)
   \        0x0   0xE92D 0x4FFE      PUSH     {R1-R11,LR}
   \        0x4   0x4682             MOV      R10,R0
   \        0x6   0x000E             MOVS     R6,R1
   \        0x8   0x0017             MOVS     R7,R2
   \        0xA   0x4698             MOV      R8,R3
   \        0xC   0xF8DD 0x9030      LDR      R9,[SP, #+48]
    215              psa_status_t status;
    216          
    217              if (PSA_KEY_TYPE_IS_PUBLIC_KEY(type)) {
   \       0x10   0x4650             MOV      R0,R10
   \       0x12   0xB280             UXTH     R0,R0
   \       0x14   0xF410 0x40E0      ANDS     R0,R0,#0x7000
   \       0x18   0xF5B0 0x4F80      CMP      R0,#+16384
   \       0x1C   0xD135             BNE.N    ??mbedtls_psa_ecp_export_key_0
    218                  /* Check whether the public part is loaded */
    219                  if (mbedtls_ecp_is_zero(&ecp->Q)) {
   \       0x1E   0xF116 0x0068      ADDS     R0,R6,#+104
   \       0x22   0x.... 0x....      BL       mbedtls_ecp_is_zero
   \       0x26   0x2800             CMP      R0,#+0
   \       0x28   0xD014             BEQ.N    ??mbedtls_psa_ecp_export_key_1
    220                      /* Calculate the public key */
    221                      status = mbedtls_to_psa_error(
    222                          mbedtls_ecp_mul(&ecp->grp, &ecp->Q, &ecp->d, &ecp->grp.G,
    223                                          mbedtls_psa_get_random,
    224                                          MBEDTLS_PSA_RANDOM_STATE));
   \       0x2A   0x2000             MOVS     R0,#+0
   \       0x2C   0x9001             STR      R0,[SP, #+4]
   \       0x2E   0x.... 0x....      LDR.W    R0,??DataTable7_1
   \       0x32   0x9000             STR      R0,[SP, #+0]
   \       0x34   0xF116 0x031C      ADDS     R3,R6,#+28
   \       0x38   0xF116 0x0260      ADDS     R2,R6,#+96
   \       0x3C   0xF116 0x0168      ADDS     R1,R6,#+104
   \       0x40   0x0030             MOVS     R0,R6
   \       0x42   0x.... 0x....      BL       mbedtls_ecp_mul
   \       0x46   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0x4A   0x0004             MOVS     R4,R0
    225                      if (status != PSA_SUCCESS) {
   \       0x4C   0x2C00             CMP      R4,#+0
   \       0x4E   0xD001             BEQ.N    ??mbedtls_psa_ecp_export_key_1
    226                          return status;
   \       0x50   0x0020             MOVS     R0,R4
   \       0x52   0xE03F             B.N      ??mbedtls_psa_ecp_export_key_2
    227                      }
    228                  }
    229          
    230                  status = mbedtls_to_psa_error(
    231                      mbedtls_ecp_point_write_binary(&ecp->grp, &ecp->Q,
    232                                                     MBEDTLS_ECP_PF_UNCOMPRESSED,
    233                                                     data_length,
    234                                                     data,
    235                                                     data_size));
   \                     ??mbedtls_psa_ecp_export_key_1: (+1)
   \       0x54   0xF8CD 0x8004      STR      R8,[SP, #+4]
   \       0x58   0x9700             STR      R7,[SP, #+0]
   \       0x5A   0x464B             MOV      R3,R9
   \       0x5C   0x2200             MOVS     R2,#+0
   \       0x5E   0xF116 0x0168      ADDS     R1,R6,#+104
   \       0x62   0x0030             MOVS     R0,R6
   \       0x64   0x.... 0x....      BL       mbedtls_ecp_point_write_binary
   \       0x68   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0x6C   0x0005             MOVS     R5,R0
    236                  if (status != PSA_SUCCESS) {
   \       0x6E   0x2D00             CMP      R5,#+0
   \       0x70   0xD009             BEQ.N    ??mbedtls_psa_ecp_export_key_3
    237                      memset(data, 0, data_size);
   \       0x72   0xF8CD 0x8000      STR      R8,[SP, #+0]
   \       0x76   0xF05F 0x0B00      MOVS     R11,#+0
   \       0x7A   0x003C             MOVS     R4,R7
   \       0x7C   0x465A             MOV      R2,R11
   \       0x7E   0x9900             LDR      R1,[SP, #+0]
   \       0x80   0x0020             MOVS     R0,R4
   \       0x82   0x.... 0x....      BL       __aeabi_memset
    238                  }
    239          
    240                  return status;
   \                     ??mbedtls_psa_ecp_export_key_3: (+1)
   \       0x86   0x0028             MOVS     R0,R5
   \       0x88   0xE024             B.N      ??mbedtls_psa_ecp_export_key_2
    241              } else {
    242                  if (data_size < PSA_BITS_TO_BYTES(ecp->grp.nbits)) {
   \                     ??mbedtls_psa_ecp_export_key_0: (+1)
   \       0x8A   0x6C30             LDR      R0,[R6, #+64]
   \       0x8C   0x1DC0             ADDS     R0,R0,#+7
   \       0x8E   0xEBB8 0x0FD0      CMP      R8,R0, LSR #+3
   \       0x92   0xD202             BCS.N    ??mbedtls_psa_ecp_export_key_4
    243                      return PSA_ERROR_BUFFER_TOO_SMALL;
   \       0x94   0xF07F 0x0089      MVNS     R0,#+137
   \       0x98   0xE01C             B.N      ??mbedtls_psa_ecp_export_key_2
    244                  }
    245          
    246                  status = mbedtls_to_psa_error(
    247                      mbedtls_ecp_write_key(ecp,
    248                                            data,
    249                                            PSA_BITS_TO_BYTES(ecp->grp.nbits)));
   \                     ??mbedtls_psa_ecp_export_key_4: (+1)
   \       0x9A   0x6C32             LDR      R2,[R6, #+64]
   \       0x9C   0x1DD2             ADDS     R2,R2,#+7
   \       0x9E   0x08D2             LSRS     R2,R2,#+3
   \       0xA0   0x0039             MOVS     R1,R7
   \       0xA2   0x0030             MOVS     R0,R6
   \       0xA4   0x.... 0x....      BL       mbedtls_ecp_write_key
   \       0xA8   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xAC   0x0005             MOVS     R5,R0
    250                  if (status == PSA_SUCCESS) {
   \       0xAE   0x2D00             CMP      R5,#+0
   \       0xB0   0xD105             BNE.N    ??mbedtls_psa_ecp_export_key_5
    251                      *data_length = PSA_BITS_TO_BYTES(ecp->grp.nbits);
   \       0xB2   0x6C30             LDR      R0,[R6, #+64]
   \       0xB4   0x1DC0             ADDS     R0,R0,#+7
   \       0xB6   0x08C0             LSRS     R0,R0,#+3
   \       0xB8   0xF8C9 0x0000      STR      R0,[R9, #+0]
   \       0xBC   0xE009             B.N      ??mbedtls_psa_ecp_export_key_6
    252                  } else {
    253                      memset(data, 0, data_size);
   \                     ??mbedtls_psa_ecp_export_key_5: (+1)
   \       0xBE   0xF8CD 0x8000      STR      R8,[SP, #+0]
   \       0xC2   0xF05F 0x0B00      MOVS     R11,#+0
   \       0xC6   0x003C             MOVS     R4,R7
   \       0xC8   0x465A             MOV      R2,R11
   \       0xCA   0x9900             LDR      R1,[SP, #+0]
   \       0xCC   0x0020             MOVS     R0,R4
   \       0xCE   0x.... 0x....      BL       __aeabi_memset
    254                  }
    255          
    256                  return status;
   \                     ??mbedtls_psa_ecp_export_key_6: (+1)
   \       0xD2   0x0028             MOVS     R0,R5
   \                     ??mbedtls_psa_ecp_export_key_2: (+1)
   \       0xD4   0xE8BD 0x8FFE      POP      {R1-R11,PC}
    257              }
    258          }
    259          

   \                                 In section .text, align 2, keep-with-next
    260          psa_status_t mbedtls_psa_ecp_export_public_key(
    261              const psa_key_attributes_t *attributes,
    262              const uint8_t *key_buffer, size_t key_buffer_size,
    263              uint8_t *data, size_t data_size, size_t *data_length)
    264          {
   \                     mbedtls_psa_ecp_export_public_key: (+1)
   \        0x0   0xE92D 0x47FC      PUSH     {R2-R10,LR}
   \        0x4   0x4681             MOV      R9,R0
   \        0x6   0x000D             MOVS     R5,R1
   \        0x8   0x0016             MOVS     R6,R2
   \        0xA   0x001F             MOVS     R7,R3
   \        0xC   0xF8DD 0x8028      LDR      R8,[SP, #+40]
    265              psa_status_t status = PSA_ERROR_CORRUPTION_DETECTED;
   \       0x10   0xF07F 0x0A96      MVNS     R10,#+150
    266              mbedtls_ecp_keypair *ecp = NULL;
   \       0x14   0x2000             MOVS     R0,#+0
   \       0x16   0x9001             STR      R0,[SP, #+4]
    267          
    268              status = mbedtls_psa_ecp_load_representation(
    269                  attributes->core.type, attributes->core.bits,
    270                  key_buffer, key_buffer_size, &ecp);
   \       0x18   0xA801             ADD      R0,SP,#+4
   \       0x1A   0x9000             STR      R0,[SP, #+0]
   \       0x1C   0x0033             MOVS     R3,R6
   \       0x1E   0x002A             MOVS     R2,R5
   \       0x20   0xF8B9 0x1002      LDRH     R1,[R9, #+2]
   \       0x24   0xF8B9 0x0000      LDRH     R0,[R9, #+0]
   \       0x28   0x.... 0x....      BL       mbedtls_psa_ecp_load_representation
   \       0x2C   0x0004             MOVS     R4,R0
    271              if (status != PSA_SUCCESS) {
   \       0x2E   0x2C00             CMP      R4,#+0
   \       0x30   0xD001             BEQ.N    ??mbedtls_psa_ecp_export_public_key_0
    272                  return status;
   \       0x32   0x0020             MOVS     R0,R4
   \       0x34   0xE01E             B.N      ??mbedtls_psa_ecp_export_public_key_1
    273              }
    274          
    275              status = mbedtls_psa_ecp_export_key(
    276                  PSA_KEY_TYPE_ECC_PUBLIC_KEY(
    277                      PSA_KEY_TYPE_ECC_GET_FAMILY(attributes->core.type)),
    278                  ecp, data, data_size, data_length);
   \                     ??mbedtls_psa_ecp_export_public_key_0: (+1)
   \       0x36   0xF8B9 0x1000      LDRH     R1,[R9, #+0]
   \       0x3A   0x.... 0x....      LDR.W    R0,??DataTable7
   \       0x3E   0x4001             ANDS     R1,R0,R1
   \       0x40   0xF5B1 0x4F82      CMP      R1,#+16640
   \       0x44   0xD102             BNE.N    ??mbedtls_psa_ecp_export_public_key_2
   \       0x46   0xF8B9 0x0000      LDRH     R0,[R9, #+0]
   \       0x4A   0xE000             B.N      ??mbedtls_psa_ecp_export_public_key_3
   \                     ??mbedtls_psa_ecp_export_public_key_2: (+1)
   \       0x4C   0x2000             MOVS     R0,#+0
   \                     ??mbedtls_psa_ecp_export_public_key_3: (+1)
   \       0x4E   0x990B             LDR      R1,[SP, #+44]
   \       0x50   0x9100             STR      R1,[SP, #+0]
   \       0x52   0x4643             MOV      R3,R8
   \       0x54   0x003A             MOVS     R2,R7
   \       0x56   0x9901             LDR      R1,[SP, #+4]
   \       0x58   0xB2C0             UXTB     R0,R0
   \       0x5A   0xF450 0x4082      ORRS     R0,R0,#0x4100
   \       0x5E   0xB280             UXTH     R0,R0
   \       0x60   0x.... 0x....      BL       mbedtls_psa_ecp_export_key
   \       0x64   0x4682             MOV      R10,R0
    279          
    280              mbedtls_ecp_keypair_free(ecp);
   \       0x66   0x9801             LDR      R0,[SP, #+4]
   \       0x68   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    281              mbedtls_free(ecp);
   \       0x6C   0x9801             LDR      R0,[SP, #+4]
   \       0x6E   0x.... 0x....      BL       sl_free
    282          
    283              return status;
   \       0x72   0x4650             MOV      R0,R10
   \                     ??mbedtls_psa_ecp_export_public_key_1: (+1)
   \       0x74   0xE8BD 0x87F6      POP      {R1,R2,R4-R10,PC}
    284          }
    285          #endif /* defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_IMPORT) ||
    286                  * defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_EXPORT) ||
    287                  * defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_PUBLIC_KEY) */
    288          
    289          #if defined(MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_GENERATE)

   \                                 In section .text, align 2, keep-with-next
    290          psa_status_t mbedtls_psa_ecp_generate_key(
    291              const psa_key_attributes_t *attributes,
    292              uint8_t *key_buffer, size_t key_buffer_size, size_t *key_buffer_length)
    293          {
   \                     mbedtls_psa_ecp_generate_key: (+1)
   \        0x0   0xE92D 0x4FF3      PUSH     {R0,R1,R4-R11,LR}
   \        0x4   0xB0A1             SUB      SP,SP,#+132
   \        0x6   0x4683             MOV      R11,R0
   \        0x8   0x0017             MOVS     R7,R2
   \        0xA   0x4698             MOV      R8,R3
    294              psa_status_t status = PSA_ERROR_CORRUPTION_DETECTED;
   \        0xC   0xF07F 0x0096      MVNS     R0,#+150
   \       0x10   0x9000             STR      R0,[SP, #+0]
    295              int ret = MBEDTLS_ERR_ERROR_CORRUPTION_DETECTED;
   \       0x12   0xF07F 0x066D      MVNS     R6,#+109
    296          
    297              psa_ecc_family_t curve = PSA_KEY_TYPE_ECC_GET_FAMILY(
    298                  attributes->core.type);
   \       0x16   0xF8BB 0x1000      LDRH     R1,[R11, #+0]
   \       0x1A   0x.... 0x....      LDR.W    R0,??DataTable7
   \       0x1E   0x4001             ANDS     R1,R0,R1
   \       0x20   0xF5B1 0x4F82      CMP      R1,#+16640
   \       0x24   0xD102             BNE.N    ??mbedtls_psa_ecp_generate_key_0
   \       0x26   0xF8BB 0x9000      LDRH     R9,[R11, #+0]
   \       0x2A   0xE001             B.N      ??mbedtls_psa_ecp_generate_key_1
   \                     ??mbedtls_psa_ecp_generate_key_0: (+1)
   \       0x2C   0xF05F 0x0900      MOVS     R9,#+0
    299              mbedtls_ecp_group_id grp_id =
    300                  mbedtls_ecc_group_of_psa(curve, attributes->core.bits, 0);
   \                     ??mbedtls_psa_ecp_generate_key_1: (+1)
   \       0x30   0x2200             MOVS     R2,#+0
   \       0x32   0xF8BB 0x1002      LDRH     R1,[R11, #+2]
   \       0x36   0x4648             MOV      R0,R9
   \       0x38   0xB2C0             UXTB     R0,R0
   \       0x3A   0x.... 0x....      BL       mbedtls_ecc_group_of_psa
   \       0x3E   0x4682             MOV      R10,R0
    301          
    302              const mbedtls_ecp_curve_info *curve_info =
    303                  mbedtls_ecp_curve_info_from_grp_id(grp_id);
   \       0x40   0x4650             MOV      R0,R10
   \       0x42   0xB2C0             UXTB     R0,R0
   \       0x44   0x.... 0x....      BL       mbedtls_ecp_curve_info_from_grp_id
   \       0x48   0x0004             MOVS     R4,R0
    304              mbedtls_ecp_keypair ecp;
    305          
    306              if (attributes->domain_parameters_size != 0) {
   \       0x4A   0xF8DB 0x0020      LDR      R0,[R11, #+32]
   \       0x4E   0x2800             CMP      R0,#+0
   \       0x50   0xD002             BEQ.N    ??mbedtls_psa_ecp_generate_key_2
    307                  return PSA_ERROR_NOT_SUPPORTED;
   \       0x52   0xF07F 0x0085      MVNS     R0,#+133
   \       0x56   0xE02C             B.N      ??mbedtls_psa_ecp_generate_key_3
    308              }
    309          
    310              if (grp_id == MBEDTLS_ECP_DP_NONE || curve_info == NULL) {
   \                     ??mbedtls_psa_ecp_generate_key_2: (+1)
   \       0x58   0x4650             MOV      R0,R10
   \       0x5A   0xB2C0             UXTB     R0,R0
   \       0x5C   0x2800             CMP      R0,#+0
   \       0x5E   0xD001             BEQ.N    ??mbedtls_psa_ecp_generate_key_4
   \       0x60   0x2C00             CMP      R4,#+0
   \       0x62   0xD102             BNE.N    ??mbedtls_psa_ecp_generate_key_5
    311                  return PSA_ERROR_NOT_SUPPORTED;
   \                     ??mbedtls_psa_ecp_generate_key_4: (+1)
   \       0x64   0xF07F 0x0085      MVNS     R0,#+133
   \       0x68   0xE023             B.N      ??mbedtls_psa_ecp_generate_key_3
    312              }
    313          
    314              mbedtls_ecp_keypair_init(&ecp);
   \                     ??mbedtls_psa_ecp_generate_key_5: (+1)
   \       0x6A   0xA801             ADD      R0,SP,#+4
   \       0x6C   0x.... 0x....      BL       mbedtls_ecp_keypair_init
    315              ret = mbedtls_ecp_gen_key(grp_id, &ecp,
    316                                        mbedtls_psa_get_random,
    317                                        MBEDTLS_PSA_RANDOM_STATE);
   \       0x70   0x2300             MOVS     R3,#+0
   \       0x72   0x....             LDR.N    R2,??DataTable7_1
   \       0x74   0xA901             ADD      R1,SP,#+4
   \       0x76   0x4650             MOV      R0,R10
   \       0x78   0xB2C0             UXTB     R0,R0
   \       0x7A   0x.... 0x....      BL       mbedtls_ecp_gen_key
   \       0x7E   0x0005             MOVS     R5,R0
    318              if (ret != 0) {
   \       0x80   0x2D00             CMP      R5,#+0
   \       0x82   0xD006             BEQ.N    ??mbedtls_psa_ecp_generate_key_6
    319                  mbedtls_ecp_keypair_free(&ecp);
   \       0x84   0xA801             ADD      R0,SP,#+4
   \       0x86   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    320                  return mbedtls_to_psa_error(ret);
   \       0x8A   0x0028             MOVS     R0,R5
   \       0x8C   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0x90   0xE00F             B.N      ??mbedtls_psa_ecp_generate_key_3
    321              }
    322          
    323              status = mbedtls_to_psa_error(
    324                  mbedtls_ecp_write_key(&ecp, key_buffer, key_buffer_size));
   \                     ??mbedtls_psa_ecp_generate_key_6: (+1)
   \       0x92   0x003A             MOVS     R2,R7
   \       0x94   0x9922             LDR      R1,[SP, #+136]
   \       0x96   0xA801             ADD      R0,SP,#+4
   \       0x98   0x.... 0x....      BL       mbedtls_ecp_write_key
   \       0x9C   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xA0   0x0006             MOVS     R6,R0
    325          
    326              mbedtls_ecp_keypair_free(&ecp);
   \       0xA2   0xA801             ADD      R0,SP,#+4
   \       0xA4   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    327          
    328              if (status == PSA_SUCCESS) {
   \       0xA8   0x2E00             CMP      R6,#+0
   \       0xAA   0xD101             BNE.N    ??mbedtls_psa_ecp_generate_key_7
    329                  *key_buffer_length = key_buffer_size;
   \       0xAC   0xF8C8 0x7000      STR      R7,[R8, #+0]
    330              }
    331          
    332              return status;
   \                     ??mbedtls_psa_ecp_generate_key_7: (+1)
   \       0xB0   0x0030             MOVS     R0,R6
   \                     ??mbedtls_psa_ecp_generate_key_3: (+1)
   \       0xB2   0xB023             ADD      SP,SP,#+140
   \       0xB4   0xE8BD 0x8FF0      POP      {R4-R11,PC}
    333          }
    334          #endif /* MBEDTLS_PSA_BUILTIN_KEY_TYPE_ECC_KEY_PAIR_GENERATE */
    335          
    336          /****************************************************************/
    337          /* ECDSA sign/verify */
    338          /****************************************************************/
    339          
    340          #if defined(MBEDTLS_PSA_BUILTIN_ALG_ECDSA) || \
    341              defined(MBEDTLS_PSA_BUILTIN_ALG_DETERMINISTIC_ECDSA)

   \                                 In section .text, align 2, keep-with-next
    342          psa_status_t mbedtls_psa_ecdsa_sign_hash(
    343              const psa_key_attributes_t *attributes,
    344              const uint8_t *key_buffer, size_t key_buffer_size,
    345              psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    346              uint8_t *signature, size_t signature_size, size_t *signature_length)
    347          {
   \                     mbedtls_psa_ecdsa_sign_hash: (+1)
   \        0x0   0xE92D 0x4FF7      PUSH     {R0-R2,R4-R11,LR}
   \        0x4   0xB08A             SUB      SP,SP,#+40
   \        0x6   0x4683             MOV      R11,R0
   \        0x8   0x001E             MOVS     R6,R3
   \        0xA   0x9F18             LDR      R7,[SP, #+96]
   \        0xC   0xF8DD 0x8064      LDR      R8,[SP, #+100]
   \       0x10   0xF8DD 0x9068      LDR      R9,[SP, #+104]
    348              psa_status_t status = PSA_ERROR_CORRUPTION_DETECTED;
   \       0x14   0xF07F 0x0596      MVNS     R5,#+150
    349              mbedtls_ecp_keypair *ecp = NULL;
   \       0x18   0x2000             MOVS     R0,#+0
   \       0x1A   0x9004             STR      R0,[SP, #+16]
    350              int ret = MBEDTLS_ERR_ERROR_CORRUPTION_DETECTED;
   \       0x1C   0xF07F 0x006D      MVNS     R0,#+109
   \       0x20   0x9009             STR      R0,[SP, #+36]
    351              size_t curve_bytes;
    352              mbedtls_mpi r, s;
    353          
    354              status = mbedtls_psa_ecp_load_representation(attributes->core.type,
    355                                                           attributes->core.bits,
    356                                                           key_buffer,
    357                                                           key_buffer_size,
    358                                                           &ecp);
   \       0x22   0xA804             ADD      R0,SP,#+16
   \       0x24   0x9000             STR      R0,[SP, #+0]
   \       0x26   0x9B0C             LDR      R3,[SP, #+48]
   \       0x28   0x9A0B             LDR      R2,[SP, #+44]
   \       0x2A   0xF8BB 0x1002      LDRH     R1,[R11, #+2]
   \       0x2E   0xF8BB 0x0000      LDRH     R0,[R11, #+0]
   \       0x32   0x.... 0x....      BL       mbedtls_psa_ecp_load_representation
   \       0x36   0x0004             MOVS     R4,R0
    359              if (status != PSA_SUCCESS) {
   \       0x38   0x2C00             CMP      R4,#+0
   \       0x3A   0xD001             BEQ.N    ??mbedtls_psa_ecdsa_sign_hash_0
    360                  return status;
   \       0x3C   0x0020             MOVS     R0,R4
   \       0x3E   0xE04E             B.N      ??mbedtls_psa_ecdsa_sign_hash_1
    361              }
    362          
    363              curve_bytes = PSA_BITS_TO_BYTES(ecp->grp.pbits);
   \                     ??mbedtls_psa_ecdsa_sign_hash_0: (+1)
   \       0x40   0x9804             LDR      R0,[SP, #+16]
   \       0x42   0xF8D0 0xA03C      LDR      R10,[R0, #+60]
   \       0x46   0xF11A 0x0A07      ADDS     R10,R10,#+7
   \       0x4A   0xEA5F 0x0ADA      LSRS     R10,R10,#+3
    364              mbedtls_mpi_init(&r);
   \       0x4E   0xA807             ADD      R0,SP,#+28
   \       0x50   0x.... 0x....      BL       mbedtls_mpi_init
    365              mbedtls_mpi_init(&s);
   \       0x54   0xA805             ADD      R0,SP,#+20
   \       0x56   0x.... 0x....      BL       mbedtls_mpi_init
    366          
    367              if (signature_size < 2 * curve_bytes) {
   \       0x5A   0xEBB8 0x0F4A      CMP      R8,R10, LSL #+1
   \       0x5E   0xD201             BCS.N    ??mbedtls_psa_ecdsa_sign_hash_2
    368                  ret = MBEDTLS_ERR_ECP_BUFFER_TOO_SMALL;
   \       0x60   0x....             LDR.N    R5,??DataTable7_2
    369                  goto cleanup;
   \       0x62   0xE027             B.N      ??mbedtls_psa_ecdsa_sign_hash_3
    370              }
    371          
    372              if (PSA_ALG_ECDSA_IS_DETERMINISTIC(alg)) {
   \                     ??mbedtls_psa_ecdsa_sign_hash_2: (+1)
   \       0x64   0x05F0             LSLS     R0,R6,#+23
   \       0x66   0xD501             BPL.N    ??mbedtls_psa_ecdsa_sign_hash_4
    373          #if defined(MBEDTLS_PSA_BUILTIN_ALG_DETERMINISTIC_ECDSA)
    374                  psa_algorithm_t hash_alg = PSA_ALG_SIGN_GET_HASH(alg);
    375                  mbedtls_md_type_t md_alg = mbedtls_md_type_from_psa_alg(hash_alg);
    376                  MBEDTLS_MPI_CHK(mbedtls_ecdsa_sign_det_ext(
    377                                      &ecp->grp, &r, &s,
    378                                      &ecp->d, hash,
    379                                      hash_length, md_alg,
    380                                      mbedtls_psa_get_random,
    381                                      MBEDTLS_PSA_RANDOM_STATE));
    382          #else
    383                  ret = MBEDTLS_ERR_ECP_FEATURE_UNAVAILABLE;
   \       0x68   0x....             LDR.N    R5,??DataTable7_3
    384                  goto cleanup;
   \       0x6A   0xE023             B.N      ??mbedtls_psa_ecdsa_sign_hash_3
    385          #endif /* defined(MBEDTLS_PSA_BUILTIN_ALG_DETERMINISTIC_ECDSA) */
    386              } else {
    387                  (void) alg;
    388                  MBEDTLS_MPI_CHK(mbedtls_ecdsa_sign(&ecp->grp, &r, &s, &ecp->d,
    389                                                     hash, hash_length,
    390                                                     mbedtls_psa_get_random,
    391                                                     MBEDTLS_PSA_RANDOM_STATE));
   \                     ??mbedtls_psa_ecdsa_sign_hash_4: (+1)
   \       0x6C   0x2000             MOVS     R0,#+0
   \       0x6E   0x9003             STR      R0,[SP, #+12]
   \       0x70   0x....             LDR.N    R0,??DataTable7_1
   \       0x72   0x9002             STR      R0,[SP, #+8]
   \       0x74   0x9817             LDR      R0,[SP, #+92]
   \       0x76   0x9001             STR      R0,[SP, #+4]
   \       0x78   0x9816             LDR      R0,[SP, #+88]
   \       0x7A   0x9000             STR      R0,[SP, #+0]
   \       0x7C   0x9804             LDR      R0,[SP, #+16]
   \       0x7E   0xF110 0x0360      ADDS     R3,R0,#+96
   \       0x82   0xAA05             ADD      R2,SP,#+20
   \       0x84   0xA907             ADD      R1,SP,#+28
   \       0x86   0x9804             LDR      R0,[SP, #+16]
   \       0x88   0x.... 0x....      BL       mbedtls_ecdsa_sign
   \       0x8C   0x0005             MOVS     R5,R0
   \       0x8E   0x2800             CMP      R0,#+0
   \       0x90   0xD110             BNE.N    ??mbedtls_psa_ecdsa_sign_hash_3
    392              }
    393          
    394              MBEDTLS_MPI_CHK(mbedtls_mpi_write_binary(&r,
    395                                                       signature,
    396                                                       curve_bytes));
   \                     ??mbedtls_psa_ecdsa_sign_hash_5: (+1)
   \       0x92   0x4652             MOV      R2,R10
   \       0x94   0x0039             MOVS     R1,R7
   \       0x96   0xA807             ADD      R0,SP,#+28
   \       0x98   0x.... 0x....      BL       mbedtls_mpi_write_binary
   \       0x9C   0x0005             MOVS     R5,R0
   \       0x9E   0x2800             CMP      R0,#+0
   \       0xA0   0xD108             BNE.N    ??mbedtls_psa_ecdsa_sign_hash_3
    397              MBEDTLS_MPI_CHK(mbedtls_mpi_write_binary(&s,
    398                                                       signature + curve_bytes,
    399                                                       curve_bytes));
   \                     ??mbedtls_psa_ecdsa_sign_hash_6: (+1)
   \       0xA2   0x4652             MOV      R2,R10
   \       0xA4   0xEB07 0x010A      ADD      R1,R7,R10
   \       0xA8   0xA805             ADD      R0,SP,#+20
   \       0xAA   0x.... 0x....      BL       mbedtls_mpi_write_binary
   \       0xAE   0x0005             MOVS     R5,R0
   \       0xB0   0x2800             CMP      R0,#+0
   \       0xB2   0xD1FF             BNE.N    ??mbedtls_psa_ecdsa_sign_hash_3
    400          cleanup:
    401              mbedtls_mpi_free(&r);
   \                     ??mbedtls_psa_ecdsa_sign_hash_7: (+1)
   \                     ??mbedtls_psa_ecdsa_sign_hash_3: (+1)
   \       0xB4   0xA807             ADD      R0,SP,#+28
   \       0xB6   0x.... 0x....      BL       mbedtls_mpi_free
    402              mbedtls_mpi_free(&s);
   \       0xBA   0xA805             ADD      R0,SP,#+20
   \       0xBC   0x.... 0x....      BL       mbedtls_mpi_free
    403              if (ret == 0) {
   \       0xC0   0x2D00             CMP      R5,#+0
   \       0xC2   0xD103             BNE.N    ??mbedtls_psa_ecdsa_sign_hash_8
    404                  *signature_length = 2 * curve_bytes;
   \       0xC4   0xEA5F 0x004A      LSLS     R0,R10,#+1
   \       0xC8   0xF8C9 0x0000      STR      R0,[R9, #+0]
    405              }
    406          
    407              mbedtls_ecp_keypair_free(ecp);
   \                     ??mbedtls_psa_ecdsa_sign_hash_8: (+1)
   \       0xCC   0x9804             LDR      R0,[SP, #+16]
   \       0xCE   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    408              mbedtls_free(ecp);
   \       0xD2   0x9804             LDR      R0,[SP, #+16]
   \       0xD4   0x.... 0x....      BL       sl_free
    409          
    410              return mbedtls_to_psa_error(ret);
   \       0xD8   0x0028             MOVS     R0,R5
   \       0xDA   0x.... 0x....      BL       mbedtls_to_psa_error
   \                     ??mbedtls_psa_ecdsa_sign_hash_1: (+1)
   \       0xDE   0xB00D             ADD      SP,SP,#+52
   \       0xE0   0xE8BD 0x8FF0      POP      {R4-R11,PC}
    411          }
    412          

   \                                 In section .text, align 2, keep-with-next
    413          psa_status_t mbedtls_psa_ecp_load_public_part(mbedtls_ecp_keypair *ecp)
    414          {
   \                     mbedtls_psa_ecp_load_public_part: (+1)
   \        0x0   0xB53E             PUSH     {R1-R5,LR}
   \        0x2   0x0004             MOVS     R4,R0
    415              int ret = 0;
   \        0x4   0x2500             MOVS     R5,#+0
    416          
    417              /* Check whether the public part is loaded. If not, load it. */
    418              if (mbedtls_ecp_is_zero(&ecp->Q)) {
   \        0x6   0xF114 0x0068      ADDS     R0,R4,#+104
   \        0xA   0x.... 0x....      BL       mbedtls_ecp_is_zero
   \        0xE   0x2800             CMP      R0,#+0
   \       0x10   0xD00D             BEQ.N    ??mbedtls_psa_ecp_load_public_part_0
    419                  ret = mbedtls_ecp_mul(&ecp->grp, &ecp->Q,
    420                                        &ecp->d, &ecp->grp.G,
    421                                        mbedtls_psa_get_random,
    422                                        MBEDTLS_PSA_RANDOM_STATE);
   \       0x12   0x2000             MOVS     R0,#+0
   \       0x14   0x9001             STR      R0,[SP, #+4]
   \       0x16   0x....             LDR.N    R0,??DataTable7_1
   \       0x18   0x9000             STR      R0,[SP, #+0]
   \       0x1A   0xF114 0x031C      ADDS     R3,R4,#+28
   \       0x1E   0xF114 0x0260      ADDS     R2,R4,#+96
   \       0x22   0xF114 0x0168      ADDS     R1,R4,#+104
   \       0x26   0x0020             MOVS     R0,R4
   \       0x28   0x.... 0x....      BL       mbedtls_ecp_mul
   \       0x2C   0x0005             MOVS     R5,R0
    423              }
    424          
    425              return mbedtls_to_psa_error(ret);
   \                     ??mbedtls_psa_ecp_load_public_part_0: (+1)
   \       0x2E   0x0028             MOVS     R0,R5
   \       0x30   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0x34   0xBD3E             POP      {R1-R5,PC}
    426          }
    427          

   \                                 In section .text, align 2, keep-with-next
    428          psa_status_t mbedtls_psa_ecdsa_verify_hash(
    429              const psa_key_attributes_t *attributes,
    430              const uint8_t *key_buffer, size_t key_buffer_size,
    431              psa_algorithm_t alg, const uint8_t *hash, size_t hash_length,
    432              const uint8_t *signature, size_t signature_length)
    433          {
   \                     mbedtls_psa_ecdsa_verify_hash: (+1)
   \        0x0   0xE92D 0x4FFF      PUSH     {R0-R11,LR}
   \        0x4   0xB087             SUB      SP,SP,#+28
   \        0x6   0x4683             MOV      R11,R0
   \        0x8   0x9E14             LDR      R6,[SP, #+80]
   \        0xA   0x9F15             LDR      R7,[SP, #+84]
   \        0xC   0xF8DD 0x8058      LDR      R8,[SP, #+88]
   \       0x10   0xF8DD 0x905C      LDR      R9,[SP, #+92]
    434              psa_status_t status = PSA_ERROR_CORRUPTION_DETECTED;
   \       0x14   0xF07F 0x0496      MVNS     R4,#+150
    435              mbedtls_ecp_keypair *ecp = NULL;
   \       0x18   0x2000             MOVS     R0,#+0
   \       0x1A   0x9002             STR      R0,[SP, #+8]
    436              size_t curve_bytes;
    437              mbedtls_mpi r, s;
    438          
    439              (void) alg;
    440          
    441              status = mbedtls_psa_ecp_load_representation(attributes->core.type,
    442                                                           attributes->core.bits,
    443                                                           key_buffer,
    444                                                           key_buffer_size,
    445                                                           &ecp);
   \       0x1C   0xA802             ADD      R0,SP,#+8
   \       0x1E   0x9000             STR      R0,[SP, #+0]
   \       0x20   0x9B09             LDR      R3,[SP, #+36]
   \       0x22   0x9A08             LDR      R2,[SP, #+32]
   \       0x24   0xF8BB 0x1002      LDRH     R1,[R11, #+2]
   \       0x28   0xF8BB 0x0000      LDRH     R0,[R11, #+0]
   \       0x2C   0x.... 0x....      BL       mbedtls_psa_ecp_load_representation
   \       0x30   0x0005             MOVS     R5,R0
    446              if (status != PSA_SUCCESS) {
   \       0x32   0x2D00             CMP      R5,#+0
   \       0x34   0xD001             BEQ.N    ??mbedtls_psa_ecdsa_verify_hash_0
    447                  return status;
   \       0x36   0x0028             MOVS     R0,R5
   \       0x38   0xE049             B.N      ??mbedtls_psa_ecdsa_verify_hash_1
    448              }
    449          
    450              curve_bytes = PSA_BITS_TO_BYTES(ecp->grp.pbits);
   \                     ??mbedtls_psa_ecdsa_verify_hash_0: (+1)
   \       0x3A   0x9802             LDR      R0,[SP, #+8]
   \       0x3C   0xF8D0 0xA03C      LDR      R10,[R0, #+60]
   \       0x40   0xF11A 0x0A07      ADDS     R10,R10,#+7
   \       0x44   0xEA5F 0x0ADA      LSRS     R10,R10,#+3
    451              mbedtls_mpi_init(&r);
   \       0x48   0xA805             ADD      R0,SP,#+20
   \       0x4A   0x.... 0x....      BL       mbedtls_mpi_init
    452              mbedtls_mpi_init(&s);
   \       0x4E   0xA803             ADD      R0,SP,#+12
   \       0x50   0x.... 0x....      BL       mbedtls_mpi_init
    453          
    454              if (signature_length != 2 * curve_bytes) {
   \       0x54   0xEBB9 0x0F4A      CMP      R9,R10, LSL #+1
   \       0x58   0xD002             BEQ.N    ??mbedtls_psa_ecdsa_verify_hash_2
    455                  status = PSA_ERROR_INVALID_SIGNATURE;
   \       0x5A   0xF07F 0x0494      MVNS     R4,#+148
    456                  goto cleanup;
   \       0x5E   0xE029             B.N      ??mbedtls_psa_ecdsa_verify_hash_3
    457              }
    458          
    459              status = mbedtls_to_psa_error(mbedtls_mpi_read_binary(&r,
    460                                                                    signature,
    461                                                                    curve_bytes));
   \                     ??mbedtls_psa_ecdsa_verify_hash_2: (+1)
   \       0x60   0x4652             MOV      R2,R10
   \       0x62   0x4641             MOV      R1,R8
   \       0x64   0xA805             ADD      R0,SP,#+20
   \       0x66   0x.... 0x....      BL       mbedtls_mpi_read_binary
   \       0x6A   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0x6E   0x0004             MOVS     R4,R0
    462              if (status != PSA_SUCCESS) {
   \       0x70   0x2C00             CMP      R4,#+0
   \       0x72   0xD11F             BNE.N    ??mbedtls_psa_ecdsa_verify_hash_3
    463                  goto cleanup;
    464              }
    465          
    466              status = mbedtls_to_psa_error(mbedtls_mpi_read_binary(&s,
    467                                                                    signature + curve_bytes,
    468                                                                    curve_bytes));
   \                     ??mbedtls_psa_ecdsa_verify_hash_4: (+1)
   \       0x74   0x4652             MOV      R2,R10
   \       0x76   0xEB08 0x010A      ADD      R1,R8,R10
   \       0x7A   0xA803             ADD      R0,SP,#+12
   \       0x7C   0x.... 0x....      BL       mbedtls_mpi_read_binary
   \       0x80   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0x84   0x0004             MOVS     R4,R0
    469              if (status != PSA_SUCCESS) {
   \       0x86   0x2C00             CMP      R4,#+0
   \       0x88   0xD114             BNE.N    ??mbedtls_psa_ecdsa_verify_hash_3
    470                  goto cleanup;
    471              }
    472          
    473              status = mbedtls_psa_ecp_load_public_part(ecp);
   \                     ??mbedtls_psa_ecdsa_verify_hash_5: (+1)
   \       0x8A   0x9802             LDR      R0,[SP, #+8]
   \       0x8C   0x.... 0x....      BL       mbedtls_psa_ecp_load_public_part
   \       0x90   0x0004             MOVS     R4,R0
    474              if (status != PSA_SUCCESS) {
   \       0x92   0x2C00             CMP      R4,#+0
   \       0x94   0xD10E             BNE.N    ??mbedtls_psa_ecdsa_verify_hash_3
    475                  goto cleanup;
    476              }
    477          
    478              status = mbedtls_to_psa_error(mbedtls_ecdsa_verify(&ecp->grp, hash,
    479                                                                 hash_length, &ecp->Q,
    480                                                                 &r, &s));
   \                     ??mbedtls_psa_ecdsa_verify_hash_6: (+1)
   \       0x96   0xA803             ADD      R0,SP,#+12
   \       0x98   0x9001             STR      R0,[SP, #+4]
   \       0x9A   0xA805             ADD      R0,SP,#+20
   \       0x9C   0x9000             STR      R0,[SP, #+0]
   \       0x9E   0x9802             LDR      R0,[SP, #+8]
   \       0xA0   0xF110 0x0368      ADDS     R3,R0,#+104
   \       0xA4   0x003A             MOVS     R2,R7
   \       0xA6   0x0031             MOVS     R1,R6
   \       0xA8   0x9802             LDR      R0,[SP, #+8]
   \       0xAA   0x.... 0x....      BL       mbedtls_ecdsa_verify
   \       0xAE   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xB2   0x0004             MOVS     R4,R0
    481          cleanup:
    482              mbedtls_mpi_free(&r);
   \                     ??mbedtls_psa_ecdsa_verify_hash_3: (+1)
   \       0xB4   0xA805             ADD      R0,SP,#+20
   \       0xB6   0x.... 0x....      BL       mbedtls_mpi_free
    483              mbedtls_mpi_free(&s);
   \       0xBA   0xA803             ADD      R0,SP,#+12
   \       0xBC   0x.... 0x....      BL       mbedtls_mpi_free
    484              mbedtls_ecp_keypair_free(ecp);
   \       0xC0   0x9802             LDR      R0,[SP, #+8]
   \       0xC2   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    485              mbedtls_free(ecp);
   \       0xC6   0x9802             LDR      R0,[SP, #+8]
   \       0xC8   0x.... 0x....      BL       sl_free
    486          
    487              return status;
   \       0xCC   0x0020             MOVS     R0,R4
   \                     ??mbedtls_psa_ecdsa_verify_hash_1: (+1)
   \       0xCE   0xB00B             ADD      SP,SP,#+44
   \       0xD0   0xE8BD 0x8FF0      POP      {R4-R11,PC}
    488          }
    489          
    490          #endif /* defined(MBEDTLS_PSA_BUILTIN_ALG_ECDSA) || \
    491                  * defined(MBEDTLS_PSA_BUILTIN_ALG_DETERMINISTIC_ECDSA) */
    492          
    493          /****************************************************************/
    494          /* ECDH Key Agreement */
    495          /****************************************************************/
    496          
    497          #if defined(MBEDTLS_PSA_BUILTIN_ALG_ECDH)

   \                                 In section .text, align 2, keep-with-next
    498          psa_status_t mbedtls_psa_key_agreement_ecdh(
    499              const psa_key_attributes_t *attributes,
    500              const uint8_t *key_buffer, size_t key_buffer_size,
    501              psa_algorithm_t alg, const uint8_t *peer_key, size_t peer_key_length,
    502              uint8_t *shared_secret, size_t shared_secret_size,
    503              size_t *shared_secret_length)
    504          {
   \                     mbedtls_psa_key_agreement_ecdh: (+1)
   \        0x0   0xE92D 0x4FFE      PUSH     {R1-R11,LR}
   \        0x4   0xB0AE             SUB      SP,SP,#+184
   \        0x6   0x4683             MOV      R11,R0
   \        0x8   0x9E3B             LDR      R6,[SP, #+236]
   \        0xA   0x9F3C             LDR      R7,[SP, #+240]
   \        0xC   0xF8DD 0x80F4      LDR      R8,[SP, #+244]
   \       0x10   0xF8DD 0x90F8      LDR      R9,[SP, #+248]
    505              psa_status_t status;
    506              if (!PSA_KEY_TYPE_IS_ECC_KEY_PAIR(attributes->core.type) ||
    507                  !PSA_ALG_IS_ECDH(alg)) {
   \       0x14   0xF8BB 0x0000      LDRH     R0,[R11, #+0]
   \       0x18   0xF030 0x00FF      BICS     R0,R0,#0xFF
   \       0x1C   0xF5B0 0x4FE2      CMP      R0,#+28928
   \       0x20   0xD107             BNE.N    ??mbedtls_psa_key_agreement_ecdh_0
   \       0x22   0x9930             LDR      R1,[SP, #+192]
   \       0x24   0x0C09             LSRS     R1,R1,#+16
   \       0x26   0x0409             LSLS     R1,R1,#+16
   \       0x28   0xF051 0x6110      ORRS     R1,R1,#0x9000000
   \       0x2C   0x....             LDR.N    R0,??DataTable7_4
   \       0x2E   0x4281             CMP      R1,R0
   \       0x30   0xD002             BEQ.N    ??mbedtls_psa_key_agreement_ecdh_1
    508                  return PSA_ERROR_INVALID_ARGUMENT;
   \                     ??mbedtls_psa_key_agreement_ecdh_0: (+1)
   \       0x32   0xF07F 0x0086      MVNS     R0,#+134
   \       0x36   0xE06F             B.N      ??mbedtls_psa_key_agreement_ecdh_2
    509              }
    510              mbedtls_ecp_keypair *ecp = NULL;
   \                     ??mbedtls_psa_key_agreement_ecdh_1: (+1)
   \       0x38   0x2000             MOVS     R0,#+0
   \       0x3A   0x9002             STR      R0,[SP, #+8]
    511              status = mbedtls_psa_ecp_load_representation(
    512                  attributes->core.type,
    513                  attributes->core.bits,
    514                  key_buffer,
    515                  key_buffer_size,
    516                  &ecp);
   \       0x3C   0xA802             ADD      R0,SP,#+8
   \       0x3E   0x9000             STR      R0,[SP, #+0]
   \       0x40   0x9B2F             LDR      R3,[SP, #+188]
   \       0x42   0x9A2E             LDR      R2,[SP, #+184]
   \       0x44   0xF8BB 0x1002      LDRH     R1,[R11, #+2]
   \       0x48   0xF8BB 0x0000      LDRH     R0,[R11, #+0]
   \       0x4C   0x.... 0x....      BL       mbedtls_psa_ecp_load_representation
   \       0x50   0x0005             MOVS     R5,R0
    517              if (status != PSA_SUCCESS) {
   \       0x52   0x2D00             CMP      R5,#+0
   \       0x54   0xD001             BEQ.N    ??mbedtls_psa_key_agreement_ecdh_3
    518                  return status;
   \       0x56   0x0028             MOVS     R0,R5
   \       0x58   0xE05E             B.N      ??mbedtls_psa_key_agreement_ecdh_2
    519              }
    520              mbedtls_ecp_keypair *their_key = NULL;
   \                     ??mbedtls_psa_key_agreement_ecdh_3: (+1)
   \       0x5A   0x2000             MOVS     R0,#+0
   \       0x5C   0x9003             STR      R0,[SP, #+12]
    521              mbedtls_ecdh_context ecdh;
    522              size_t bits = 0;
   \       0x5E   0x2000             MOVS     R0,#+0
   \       0x60   0x9004             STR      R0,[SP, #+16]
    523              psa_ecc_family_t curve = mbedtls_ecc_group_to_psa(ecp->grp.id, &bits);
   \       0x62   0xA904             ADD      R1,SP,#+16
   \       0x64   0x9802             LDR      R0,[SP, #+8]
   \       0x66   0x7800             LDRB     R0,[R0, #+0]
   \       0x68   0x.... 0x....      BL       mbedtls_ecc_group_to_psa
   \       0x6C   0x4682             MOV      R10,R0
    524              mbedtls_ecdh_init(&ecdh);
   \       0x6E   0xA805             ADD      R0,SP,#+20
   \       0x70   0x.... 0x....      BL       mbedtls_ecdh_init
    525          
    526              status = mbedtls_psa_ecp_load_representation(
    527                  PSA_KEY_TYPE_ECC_PUBLIC_KEY(curve),
    528                  bits,
    529                  peer_key,
    530                  peer_key_length,
    531                  &their_key);
   \       0x74   0xA803             ADD      R0,SP,#+12
   \       0x76   0x9000             STR      R0,[SP, #+0]
   \       0x78   0x0033             MOVS     R3,R6
   \       0x7A   0x9A3A             LDR      R2,[SP, #+232]
   \       0x7C   0x9904             LDR      R1,[SP, #+16]
   \       0x7E   0x4650             MOV      R0,R10
   \       0x80   0xB2C0             UXTB     R0,R0
   \       0x82   0xF450 0x4082      ORRS     R0,R0,#0x4100
   \       0x86   0xB280             UXTH     R0,R0
   \       0x88   0x.... 0x....      BL       mbedtls_psa_ecp_load_representation
   \       0x8C   0x0004             MOVS     R4,R0
    532              if (status != PSA_SUCCESS) {
   \       0x8E   0x2C00             CMP      R4,#+0
   \       0x90   0xD12C             BNE.N    ??mbedtls_psa_key_agreement_ecdh_4
    533                  goto exit;
    534              }
    535          
    536              status = mbedtls_to_psa_error(
    537                  mbedtls_ecdh_get_params(&ecdh, their_key, MBEDTLS_ECDH_THEIRS));
   \                     ??mbedtls_psa_key_agreement_ecdh_5: (+1)
   \       0x92   0x2201             MOVS     R2,#+1
   \       0x94   0x9903             LDR      R1,[SP, #+12]
   \       0x96   0xA805             ADD      R0,SP,#+20
   \       0x98   0x.... 0x....      BL       mbedtls_ecdh_get_params
   \       0x9C   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xA0   0x0004             MOVS     R4,R0
    538              if (status != PSA_SUCCESS) {
   \       0xA2   0x2C00             CMP      R4,#+0
   \       0xA4   0xD122             BNE.N    ??mbedtls_psa_key_agreement_ecdh_4
    539                  goto exit;
    540              }
    541              status = mbedtls_to_psa_error(
    542                  mbedtls_ecdh_get_params(&ecdh, ecp, MBEDTLS_ECDH_OURS));
   \                     ??mbedtls_psa_key_agreement_ecdh_6: (+1)
   \       0xA6   0x2200             MOVS     R2,#+0
   \       0xA8   0x9902             LDR      R1,[SP, #+8]
   \       0xAA   0xA805             ADD      R0,SP,#+20
   \       0xAC   0x.... 0x....      BL       mbedtls_ecdh_get_params
   \       0xB0   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xB4   0x0004             MOVS     R4,R0
    543              if (status != PSA_SUCCESS) {
   \       0xB6   0x2C00             CMP      R4,#+0
   \       0xB8   0xD118             BNE.N    ??mbedtls_psa_key_agreement_ecdh_4
    544                  goto exit;
    545              }
    546          
    547              status = mbedtls_to_psa_error(
    548                  mbedtls_ecdh_calc_secret(&ecdh,
    549                                           shared_secret_length,
    550                                           shared_secret, shared_secret_size,
    551                                           mbedtls_psa_get_random,
    552                                           MBEDTLS_PSA_RANDOM_STATE));
   \                     ??mbedtls_psa_key_agreement_ecdh_7: (+1)
   \       0xBA   0x2000             MOVS     R0,#+0
   \       0xBC   0x9001             STR      R0,[SP, #+4]
   \       0xBE   0x....             LDR.N    R0,??DataTable7_1
   \       0xC0   0x9000             STR      R0,[SP, #+0]
   \       0xC2   0x4643             MOV      R3,R8
   \       0xC4   0x003A             MOVS     R2,R7
   \       0xC6   0x4649             MOV      R1,R9
   \       0xC8   0xA805             ADD      R0,SP,#+20
   \       0xCA   0x.... 0x....      BL       mbedtls_ecdh_calc_secret
   \       0xCE   0x.... 0x....      BL       mbedtls_to_psa_error
   \       0xD2   0x0004             MOVS     R4,R0
    553              if (status != PSA_SUCCESS) {
   \       0xD4   0x2C00             CMP      R4,#+0
   \       0xD6   0xD109             BNE.N    ??mbedtls_psa_key_agreement_ecdh_4
    554                  goto exit;
    555              }
    556              if (PSA_BITS_TO_BYTES(bits) != *shared_secret_length) {
   \                     ??mbedtls_psa_key_agreement_ecdh_8: (+1)
   \       0xD8   0x9904             LDR      R1,[SP, #+16]
   \       0xDA   0x1DC9             ADDS     R1,R1,#+7
   \       0xDC   0x08C9             LSRS     R1,R1,#+3
   \       0xDE   0xF8D9 0x0000      LDR      R0,[R9, #+0]
   \       0xE2   0x4281             CMP      R1,R0
   \       0xE4   0xD002             BEQ.N    ??mbedtls_psa_key_agreement_ecdh_4
    557                  status = PSA_ERROR_CORRUPTION_DETECTED;
   \       0xE6   0xF07F 0x0096      MVNS     R0,#+150
   \       0xEA   0x0004             MOVS     R4,R0
    558              }
    559          exit:
    560              if (status != PSA_SUCCESS) {
   \                     ??mbedtls_psa_key_agreement_ecdh_4: (+1)
   \       0xEC   0x2C00             CMP      R4,#+0
   \       0xEE   0xD003             BEQ.N    ??mbedtls_psa_key_agreement_ecdh_9
    561                  mbedtls_platform_zeroize(shared_secret, shared_secret_size);
   \       0xF0   0x4641             MOV      R1,R8
   \       0xF2   0x0038             MOVS     R0,R7
   \       0xF4   0x.... 0x....      BL       mbedtls_platform_zeroize
    562              }
    563              mbedtls_ecdh_free(&ecdh);
   \                     ??mbedtls_psa_key_agreement_ecdh_9: (+1)
   \       0xF8   0xA805             ADD      R0,SP,#+20
   \       0xFA   0x.... 0x....      BL       mbedtls_ecdh_free
    564              mbedtls_ecp_keypair_free(their_key);
   \       0xFE   0x9803             LDR      R0,[SP, #+12]
   \      0x100   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    565              mbedtls_free(their_key);
   \      0x104   0x9803             LDR      R0,[SP, #+12]
   \      0x106   0x.... 0x....      BL       sl_free
    566              mbedtls_ecp_keypair_free(ecp);
   \      0x10A   0x9802             LDR      R0,[SP, #+8]
   \      0x10C   0x.... 0x....      BL       mbedtls_ecp_keypair_free
    567              mbedtls_free(ecp);
   \      0x110   0x9802             LDR      R0,[SP, #+8]
   \      0x112   0x.... 0x....      BL       sl_free
    568              return status;
   \      0x116   0x0020             MOVS     R0,R4
   \                     ??mbedtls_psa_key_agreement_ecdh_2: (+1)
   \      0x118   0xB031             ADD      SP,SP,#+196
   \      0x11A   0xE8BD 0x8FF0      POP      {R4-R11,PC}
    569          }

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7:
   \        0x0   0xFFFF'CF00        DC32     0xffffcf00

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_1:
   \        0x0   0x....'....        DC32     mbedtls_psa_get_random

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_2:
   \        0x0   0xFFFF'B100        DC32     0xffffb100

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_3:
   \        0x0   0xFFFF'B180        DC32     0xffffb180

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable7_4:
   \        0x0   0x0902'0000        DC32     0x9020000
    570          #endif /* MBEDTLS_PSA_BUILTIN_ALG_ECDH */
    571          
    572          
    573          #endif /* MBEDTLS_PSA_CRYPTO_C */

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      88   mbedtls_psa_ecdsa_sign_hash
        88   -> mbedtls_ecdsa_sign
        88   -> mbedtls_ecp_keypair_free
        88   -> mbedtls_mpi_free
        88   -> mbedtls_mpi_init
        88   -> mbedtls_mpi_write_binary
        88   -> mbedtls_psa_ecp_load_representation
        88   -> mbedtls_to_psa_error
        88   -> sl_free
      80   mbedtls_psa_ecdsa_verify_hash
        80   -> mbedtls_ecdsa_verify
        80   -> mbedtls_ecp_keypair_free
        80   -> mbedtls_mpi_free
        80   -> mbedtls_mpi_init
        80   -> mbedtls_mpi_read_binary
        80   -> mbedtls_psa_ecp_load_public_part
        80   -> mbedtls_psa_ecp_load_representation
        80   -> mbedtls_to_psa_error
        80   -> sl_free
      48   mbedtls_psa_ecp_export_key
        48   -> __aeabi_memset
        48   -> mbedtls_ecp_is_zero
        48   -> mbedtls_ecp_mul
        48   -> mbedtls_ecp_point_write_binary
        48   -> mbedtls_ecp_write_key
        48   -> mbedtls_to_psa_error
      40   mbedtls_psa_ecp_export_public_key
        40   -> mbedtls_ecp_keypair_free
        40   -> mbedtls_psa_ecp_export_key
        40   -> mbedtls_psa_ecp_load_representation
        40   -> sl_free
     176   mbedtls_psa_ecp_generate_key
       176   -> mbedtls_ecc_group_of_psa
       176   -> mbedtls_ecp_curve_info_from_grp_id
       176   -> mbedtls_ecp_gen_key
       176   -> mbedtls_ecp_keypair_free
       176   -> mbedtls_ecp_keypair_init
       176   -> mbedtls_ecp_write_key
       176   -> mbedtls_to_psa_error
      40   mbedtls_psa_ecp_import_key
        40   -> mbedtls_ecp_keypair_free
        40   -> mbedtls_psa_ecp_export_key
        40   -> mbedtls_psa_ecp_load_representation
        40   -> sl_free
      24   mbedtls_psa_ecp_load_public_part
        24   -> mbedtls_ecp_is_zero
        24   -> mbedtls_ecp_mul
        24   -> mbedtls_to_psa_error
      48   mbedtls_psa_ecp_load_representation
        48   -> mbedtls_ecc_group_of_psa
        48   -> mbedtls_ecp_check_pubkey
        48   -> mbedtls_ecp_group_load
        48   -> mbedtls_ecp_keypair_free
        48   -> mbedtls_ecp_keypair_init
        48   -> mbedtls_ecp_point_read_binary
        48   -> mbedtls_ecp_read_key
        48   -> mbedtls_to_psa_error
        48   -> sl_calloc
        48   -> sl_free
     232   mbedtls_psa_key_agreement_ecdh
       232   -> mbedtls_ecc_group_to_psa
       232   -> mbedtls_ecdh_calc_secret
       232   -> mbedtls_ecdh_free
       232   -> mbedtls_ecdh_get_params
       232   -> mbedtls_ecdh_init
       232   -> mbedtls_ecp_keypair_free
       232   -> mbedtls_platform_zeroize
       232   -> mbedtls_psa_ecp_load_representation
       232   -> mbedtls_to_psa_error
       232   -> sl_free


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable7
       4  ??DataTable7_1
       4  ??DataTable7_2
       4  ??DataTable7_3
       4  ??DataTable7_4
     228  mbedtls_psa_ecdsa_sign_hash
     212  mbedtls_psa_ecdsa_verify_hash
     216  mbedtls_psa_ecp_export_key
     120  mbedtls_psa_ecp_export_public_key
     184  mbedtls_psa_ecp_generate_key
     138  mbedtls_psa_ecp_import_key
      54  mbedtls_psa_ecp_load_public_part
     332  mbedtls_psa_ecp_load_representation
     286  mbedtls_psa_key_agreement_ecdh

 
 1'790 bytes in section .text
 
 1'790 bytes of CODE memory

Errors: none
Warnings: none
